<script>
    (function(){
      // --- Datos de personajes (Griegos + Nórdicos esenciales) ---
      const personajes = [
        { 
          nombre: "Kratos", 
          imagen: "img/kratos.jpg", 
          descripcion: "Nacido en Esparta, conocido como El Fantasma de Esparta. Fue un general espartano que, tras pactar con Ares, se convirtió en su siervo. Tras vengarse de los dioses griegos, sobrevivió y terminó en los reinos nórdicos, donde vive con su hijo Atreus.", 
          mitologia: "Griega"
        },

        { nombre: "Ares", imagen: "img/ares.jpg", descripcion: "Dios griego de la guerra, otorgó a Kratos las Espadas del Caos. Fue derrotado por Kratos en el primer God of War.", mitologia: "Griega" },

        { nombre: "Zeus", imagen: "img/zeus.jpg", descripcion: "Principal antagonista de la etapa griega. Temía que Kratos destruyera el Olimpo. Kratos lo mata al final de God of War III.", mitologia: "Griega" },

        { nombre: "Atenea", imagen: "img/atenea.jpg", descripcion: "Diosa de la sabiduría y la guerra justa. Aliada de Kratos en los primeros juegos; luego se vuelve ambigua.", mitologia: "Griega" },

        { nombre: "Hades", imagen: "img/hades.jpg", descripcion: "Dios del inframundo. Derrotado por Kratos en God of War III, quien arranca su alma.", mitologia: "Griega" },

        { nombre: "Poseidón", imagen: "img/poseidon.jpg", descripcion: "Dios de los mares. En God of War III es el primer dios que Kratos mata.", mitologia: "Griega" },

        { nombre: "Atreus (Loki)", imagen: "img/atreus.jpg", descripcion: "Hijo de Kratos y Faye. Revelado como Loki en la mitología nórdica. Destinado a grandes eventos del Ragnarok.", mitologia: "Nórdica" },

        { nombre: "Baldur", imagen: "img/baldur.jpg", descripcion: "Hijo de Odín y Freya. Maldito con invulnerabilidad que lo vuelve incapaz de sentir nada. Antagonista principal en GoW 2018.", mitologia: "Nórdica" },

        { nombre: "Freya", imagen: "img/freya.jpg", descripcion: "Diosa Vanir de la magia. Aliada de Kratos hasta la muerte de Baldur; luego busca venganza.", mitologia: "Nórdica" },

        { nombre: "Thor", imagen: "img/thor.jpg", descripcion: "Dios del trueno. Brutal y temido, antagonista principal en Ragnarök.", mitologia: "Nórdica" },

        { nombre: "Odín", imagen: "img/odin.jpg", descripcion: "El Padre de Todo. Manipulador y obsesionado con el conocimiento. Antagonista central de God of War: Ragnarök.", mitologia: "Nórdica" }
      ];

      const placeholder = "https://via.placeholder.com/400x400?text=God+of+War";

      const container = document.getElementById('container');
      const modal = document.getElementById('modal');
      const closeBtn = document.getElementById('closeBtn');
      const modalImg = document.getElementById('modal-img');
      const modalName = document.getElementById('modal-name');
      const modalDesc = document.getElementById('modal-desc');
      const modalExtra = document.getElementById('modal-extra');
      const search = document.getElementById('search');

      function render(list){
        container.innerHTML = '';
        list.forEach((p, idx) => {
          const card = document.createElement('div');
          card.className = 'card';

          const safeName = String(p.nombre);
          const safeImg = String(p.imagen || '');
          const safeDescShort = String(p.descripcion || '');

          const imgEl = document.createElement('img');
          imgEl.className = 'thumb';
          imgEl.src = safeImg;
          imgEl.alt = safeName;
          imgEl.onerror = function(){ this.src = placeholder; };

          const meta = document.createElement('div');
          meta.className = 'meta';
          const nameEl = document.createElement('div');
          nameEl.className = 'name';
          nameEl.textContent = safeName;

          const subEl = document.createElement('div');
          subEl.className = 'sub';
          subEl.textContent = (p.mitologia ? p.mitologia + ' · ' : '') + (safeDescShort.slice(0,80) + (safeDescShort.length>80? '...':'')); 

          meta.appendChild(nameEl);
          meta.appendChild(subEl);

          card.appendChild(imgEl);
          card.appendChild(meta);

          card.dataset.index = idx;
          card.addEventListener('click', function(){ openModal(parseInt(this.dataset.index,10)); });

          container.appendChild(card);
        });
      }

      function openModal(index){
        const p = personajes[index];
        if(!p) return;
        modalName.textContent = p.nombre;
        modalDesc.textContent = p.descripcion || '';
        modalExtra.textContent = (p.mitologia ? 'Mitología: ' + p.mitologia : '');
        modalImg.src = p.imagen || placeholder;
        modalImg.onerror = function(){ this.src = placeholder; };
        modal.style.display = 'flex';
        closeBtn.focus();
      }

      function closeModal(){ modal.style.display = 'none'; }

      closeBtn.addEventListener('click', closeModal);
      modal.addEventListener('click', function(e){ if(e.target === modal) closeModal(); });
      window.addEventListener('keydown', function(e){ if(e.key === 'Escape') closeModal(); });

      search.addEventListener('input', function(){
        const q = this.value.trim().toLowerCase();
        if(!q) return render(personajes);
        const filtered = personajes.filter(p => {
          return (p.nombre && p.nombre.toLowerCase().includes(q)) 
              || (p.mitologia && p.mitologia.toLowerCase().includes(q)) 
              || (p.descripcion && p.descripcion.toLowerCase().includes(q));
        });
        render(filtered);
      });

      render(personajes);

      window.__GOW_DATA__ = { personajes, render, openModal };
    })();
</script>


